var globalCacheForjQueryReplacement=window.jQuery;/**
 * Nooku Framework - http://nooku.org/framework
 *
 * @copyright	Copyright (C) 2015 Johan Janssens and Timble CVBA. (http://www.timble.net)
 * @license		GNU GPLv3 <http://www.gnu.org/licenses/gpl.html>
 * @link		https://github.com/nooku/nooku-framework for the canonical source repository
 */
if(window.jQuery=window.kQuery,!Koowa)var Koowa={};Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e});/*!
 * klass: a classical JS OOP fa√ßade
 * https://github.com/ded/klass
 * License MIT (c) Dustin Diaz & Jacob Thornton 2012
 */
var klass=function(){function a(a){return e.call(b(a)?a:function(){},a,1)}function b(a){return typeof a===h}function c(a,b,c){return function(){var d=this.supr;this.supr=c[j][a];var e={}.fabricatedUndefined,f=e;try{f=b.apply(this,arguments)}finally{this.supr=d}return f}}function d(a,d,e){for(var f in d)d.hasOwnProperty(f)&&(a[f]=b(d[f])&&b(e[j][f])&&i.test(d[f])?c(f,d[f],e):d[f])}function e(a,c){function e(){}function f(){this.initialize?this.initialize.apply(this,arguments):(c||i&&g.apply(this,arguments),k.apply(this,arguments))}e[j]=this[j];var g=this,h=new e,i=b(a),k=i?a:this,l=i?{}:a;return f.methods=function(a){return d(h,a,g),f[j]=h,this},f.methods.call(f,l).prototype.constructor=f,f.extend=arguments.callee,f[j].implement=f.statics=function(a,b){return a="string"==typeof a?function(){var c={};return c[a]=b,c}():a,d(this,a,g),this},f}var f=this,g=f.klass,h="function",i=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,j="prototype";return a.noConflict=function(){return f.klass=g,this},a}();/**
 * Nooku Framework - http://nooku.org/framework
 *
 * @copyright	Copyright (C) 2007 - 2014 Johan Janssens and Timble CVBA. (http://www.timble.net)
 * @license		GNU GPLv3 <http://www.gnu.org/licenses/gpl.html>
 * @link		https://github.com/nooku/nooku-framework for the canonical source repository
 */
if(function(a){Koowa.Class=klass({options:{},getOptions:function(){return{}},initialize:function(){this.setOptions(this.getOptions())},setOptions:function(b){return"object"==typeof b&&(this.options=a.extend(!0,{},this.options,b)),this}})}(window.kQuery),!Koowa)var Koowa={};!function(a){a(function(){a(".k-js-submittable").on("click.koowa",function(b){b.preventDefault(),new Koowa.Form(a(b.target).data("config")).submit()}),a(".k-js-grid-controller").each(function(){new Koowa.Controller.Grid({form:this})}),a(".k-js-form-controller").each(function(){new Koowa.Controller.Form({form:this})})}),Koowa.Translator||(Koowa.Translator=Koowa.Class.extend({translations:{},translate:function(a,b){if("undefined"!=typeof this.translations[a.toLowerCase()]&&(a=this.translations[a.toLowerCase()]),"object"==typeof b&&null!==b)for(var c in b)if(b.hasOwnProperty(c)){var d="{"+c+"}".replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");a=a.replace(new RegExp(d,"g"),b[c])}return a},loadTranslations:function(a){for(var b in a)a.hasOwnProperty(b)&&(this.translations[b.toLowerCase()]=a[b]);return this}}),Koowa.translator=new Koowa.Translator,Koowa.translate=Koowa.translator.translate.bind(Koowa.translator)),Koowa.Form=Koowa.Class.extend({initialize:function(b){this.config=b,this.config.element?this.form=a(document[this.config.element]):(this.form=a("<form/>",{name:"dynamicform",method:this.config.method||"POST",action:this.config.url}),a(document.body).append(this.form))},addField:function(b,c){if(a.isArray(c)){var d,e=this;"[]"===b.substr(-2)&&(b=b.substr(0,b.length-2)),a.each(c,function(a,c){d=b+"["+a+"]",e.addField(d,c)})}else{var f=a("<input/>",{name:b,value:c,type:"hidden"});f.appendTo(this.form)}return this},submit:function(){var b=this;this.config.params&&a.each(this.config.params,function(a,c){b.addField(a,c)}),this.form.submit()}}),Koowa.Controller=Koowa.Class.extend({form:null,toolbar:null,buttons:null,token_name:null,token_value:null,getOptions:function(){return a.extend(this.supr(),{toolbar:".k-toolbar",url:window.location.href})},initialize:function(b){var c=this;this.supr(),this.setOptions(b),this.form=a(this.options.form),this.setOptions(this.form.data()),this.form.prop("action")&&(this.options.url=this.form.attr("action")),this.toolbar=a(this.options.toolbar),this.form.data("controller",this),this.on("execute",function(){return c.execute.apply(c,arguments)}),this.token_name=this.form.data("token-name"),this.token_value=this.form.data("token-value"),this.toolbar&&this.setToolbar()},setToolbar:function(){var b=this;this.buttons=this.toolbar.find(".toolbar[data-action]"),this.buttons.each(function(){var c=a(this),d={},e=c.data(),f=e.data;e.eventAdded||("object"!=typeof f&&(f=f&&"string"===a.type(f)?a.parseJSON(f):{}),b.token_name&&(f[b.token_name]=b.token_value),d.validate="novalidate"!==e.novalidate,d.data=f,d.action=e.action,c.on("click.koowa",function(a){if(a.preventDefault(),d.trigger=c,!c.hasClass("k-is-disabled")){var f=c.data("prompt");if(f&&!confirm(f))return;b.setOptions(e),b.trigger("execute",[d])}}),c.data("event-added",!0))})},execute:function(a,b){if(b.action[0]){var c=b.action[0].toUpperCase()+b.action.substr(1),d="_action"+c;"undefined"==typeof b.validate&&(b.validate=!0),this.trigger("before"+c,b)&&(d=this[d]?d:"_actionDefault",this[d].call(this,b),this.trigger("after"+c,b))}return this},on:function(a,b){return this.form.on("koowa:"+a,b)},off:function(a,b){return this.form.off("koowa:"+a,b)},trigger:function(b,c){var d=a.Event("koowa:"+b);return this.form.trigger(d,c),!d.isDefaultPrevented()},checkValidity:function(){var a;this.buttons&&(this.trigger("beforeValidate"),a=this.buttons.filter('[data-novalidate!="novalidate"]'),this.trigger("validate")?a.removeClass("k-is-disabled"):a.addClass("k-is-disabled"),this.trigger("afterValidate"))}}),Koowa.Controller.Grid=Koowa.Controller.extend({getOptions:function(){return a.extend(this.supr(),{inputs:".k-js-grid-checkbox, .k-js-grid-checkall",ajaxify:!1})},initialize:function(a){var b=this;this.supr(a),this.grid=new Koowa.Grid(this.form),this.on("validate",this.validate),this.options.inputs&&this.buttons&&(this.checkValidity(),this.form.find(this.options.inputs).on("change.koowa",function(a,c){c||b.checkValidity()})),this.token_name=this.form.data("token-name"),this.token_value=this.form.data("token-value"),this.setTableRows(),this.form.find("thead select, tfoot select, .k-pagination select").on("change.koowa",function(){b.grid.uncheckAll(),b.options.ajaxify&&(event.preventDefault(),b.options.transport(b.options.url,b.form.serialize(),"get")),b.form.submit()})},setTableRows:function(){var b=this,c=this.form.find("tbody tr .k-js-grid-checkbox");this.form.find("tbody tr").each(function(){var d=a(this),e=d.find(".k-js-grid-checkbox");1!=d.data("readonly")&&e.length&&d.find("[data-action]").each(function(){var d=a(this),f={},g=d.data("data"),h=d.data(),i=d.data("event-type");"object"!=typeof g&&(g=g&&"string"===a.type(g)?a.parseJSON(g):{}),b.token_name&&(g[b.token_name]=b.token_value),i||(i=d.is('[type="radio"],[type="checkbox"],select')?"change":"click"),f.validate="novalidate"!==h.novalidate,f.data=g,f.action=h.action,d.on(i+".koowa",function(){c.prop("checked",""),e.prop("checked","checked"),c.trigger("change",!0),f.trigger=d,b.setOptions(h),b.trigger("execute",[f])})})})},validate:function(){return Koowa.Grid.getIdQuery()||!1},_actionDelete:function(a){return a.method="delete",this._actionDefault(a)},_actionDefault:function(b){var c,d=Koowa.Grid.getIdQuery(),e=this.options.url.match(/\?/)?"&":"?";return b.validate&&!this.trigger("validate",[b])?!1:(c={method:"post",url:this.options.url+(d?e+d:""),params:a.extend({},{_action:b.action},b.data)},b.method&&(c.params._method=b.method),void new Koowa.Form(c).submit())}}),Koowa.Controller.Form=Koowa.Controller.extend({_actionDefault:function(b){return b.validate&&!this.trigger("validate",[b])?!1:(this.form.append(a("<input/>",{name:"_action",type:"hidden",value:b.action})),this.trigger("submit",[b]),void this.form.submit())}})}(window.kQuery),window.jQuery=globalCacheForjQueryReplacement,globalCacheForjQueryReplacement=void 0;
//# sourceMappingURL=koowa.js.map